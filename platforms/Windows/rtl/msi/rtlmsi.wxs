﻿<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package
      Language="1033"
      Manufacturer="swift.org"
      Name="!(loc.Runtime_ProductName_$(sys.BUILDARCH))"
      UpgradeCode="bea8c6dc-f73e-445b-9486-2333d1cf2886"
      Version="$(ProductVersion)"
      Scope="$(PackageScope)">

    <MediaTemplate CabinetTemplate="runtime{0}.cab" EmbedCab="yes" />
    <MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeError)" />

    <DirectoryRef Id="INSTALLDIR">
      <Directory Name="Runtimes">
        <Directory Name="$(ProductVersion)">
          <Directory Name="usr">
            <Directory Id="runtimes_usr_bin" Name="bin" />
          </Directory>
        </Directory>
      </Directory>
    </DirectoryRef>

    <SetDirectory Id="RUNTIMEDIR" Value="[runtimes_usr_bin]" Sequence="first" />

    <ComponentGroup Id="EnvironmentVariables" Directory="RUNTIMEDIR">
      <Component Id="SystemEnvironmentVariables" Condition="ALLUSERS=1" Guid="8681d813-eb32-46f9-8b1c-f622b38b5eaf">
        <Environment Id="SystemPath" Action="set" Name="Path" Part="last" Permanent="no" System="yes" Value="[runtimes_usr_bin]" />
      </Component>
      <Component Id="UserEnvironmentVariables" Condition="NOT ALLUSERS=1" Guid="b83f6521-8708-4e2d-afef-076d8cdd7528">
        <Environment Id="UserPath" Action="set" Name="Path" Part="last" Permanent="no" System="no" Value="[runtimes_usr_bin]" />
      </Component>
    </ComponentGroup>

    <Feature Id="SwiftRuntime" AllowAbsent="no" Title="!(loc.Runtime_ProductName_$(sys.BUILDARCH))">
      <ComponentGroupRef Id="swift_runtime" />
      <ComponentGroupRef Id="EnvironmentVariables" />
    </Feature>
  </Package>
</Wix>
